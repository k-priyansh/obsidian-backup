---
category:
  - Web
tags:
  - opencart
  - open-redirection
  - XSS
  - CSRF
  - path-traversal
  - vulnerability-research
  - code-review
  - RCE
  - vulnerability-research/finished
last-time: 2023-10-15
---

# General Information
## Time-line

>[!summary] Events and findings timeline:
>**06/07/2023**: 
>- Set up the environment and started the analysis
>
>**25/09/2023**: 
>- Tested and confirmed CVE-2023-2315 - Path Traversal in `log.php`, allowing to clear any writable file
>- Discovered a Path Traversal in `common/filemanager` which allows to enumerate filesystem's directories
>- Found an arbitrary file upload in `common/filemanager.upload` but cannot change extensions
>- Found an arbitrary file upload in `catalog/download.upload` but cannot guess the final name
>
>**01/10/2023:**
>- Tested various bypasses and chains in order to escalate severity for Path Traversal and File upload, but without success
>- Discovered a Self-Reflected XSS in `catalog/product.form` caused by CKEditor
>- Noticed that `user_token` is not included in Refer header when GET request are sent cross origin → [Default Referrer-Policy](<https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy#directives:~:text=strict%2Dorigin%2Dwhen%2Dcross%2Dorigin%20(default)>)
>- Discovered a parameter pollution and open redirection in `account/login.login`
>- Tested Gift and Coupon functionality: no race condition have been found, it seems that only one code for purchase is allowed. To better investigate...
>
>**11/10/2023:**
>- Discovered a path traversal in `common/security.storage` that allows to copy the content of `/system` anywhere in the filesystem
>- Discovered a RCE in `common/security.storage` caused because the `config.php` can be overwritten with any arbitrary value
>
>**12/10/2023**:
>- Fixed the PoC so that application keeps working as intended
> 
>**13/10/2023:**
>- Discovered a RCE in `common/security.admin` caused because the new `config.php` can be created injected arbitrary PHP code
>
>**14/10/2023**:
>- Finished looking all the `$file` references, without finding anything new
>- Looked at forgot password, login and registration process, without finding anything suspicious
>  
> **17/10/2023**:
>  - Contacted OpenCart at support@opencart.com
>
>**24/10/2023**:
>- Contacted OpenCart at webmaster@opencart.com
>
>**30/10/2023**:
>- Published a post (https://forum.opencart.com/viewtopic.php?t=232348) on the official OpenCart forum as a final attempt to contact the OpenCart team
>
>**02/11/2023**:
>- Sent a PM to an Administrator on the official OpenCart forum as a very last resort to contact the OpenCart staff
>as a final attempt to contact the OpenCart team.
>
>**10/11/2023**: 
>- Assigned CVE-2023-47444
>
>- **10/11/2023**: Sent a PM to another Administrator on the official OpenCart forum as a very last resort to contact the OpenCart staff.  
>- **11/11/2023**: Get a _kindly_ response from an OpenCart Administrator 
>- **14/11/2023**: Public release and opened a GitHub issue ([#12947](https://github.com/opencart/opencart/issues/12947))
>- **15/11/2023**: Opened a pull request ([#12949](https://github.com/opencart/opencart/pull/12949)) with a hotfix, but closed immediately by administrator. GitHub issue also closed by administrator after having marked it as spam and a “non vulnerability”.
>- **16/11/2023**: Fix ([#12951](https://github.com/opencart/opencart/pull/12951)) merged to master

## Canvas

![OpenCart 4.0.2.3](OpenCart%204.0.2.3.canvas)

# Set Up

- Downloaded archive: https://github.com/opencart/opencart/releases/tag/4.0.2.2
- Web server: Apache + MySQL
